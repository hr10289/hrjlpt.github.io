KanjiViewer={initialize:function(divName,strokeWidth,fontSize,zoomFactor,displayOrders,colorGroups,kanji){this.paper=new Raphael(divName,"100%","100%"),this.strokeWidth=strokeWidth,this.fontSize=fontSize,this.displayOrders=displayOrders,this.colorGroups=colorGroups,this.kanji=kanji,this.fetchNeeded=!0,this.setZoom(zoomFactor),this.refreshKanji()},setZoom:function(zoomFactor){this.paper.setViewBox(0,0,109,109)},setStrokeWidth:function(strokeWidth){this.strokeWidth=strokeWidth},setFontSize:function(fontSize){this.fontSize=fontSize},setStrokeOrdersVisible:function(visible){this.displayOrders=visible},setColorGroups:function(colorGroups){this.colorGroups=colorGroups},setKanji:function(kanji){kanji!=this.kanji&&""!=kanji&&void 0!=kanji&&(this.kanji=kanji,this.fetchNeeded=!0)},refreshKanji:function(){if(this.fetchNeeded&&""!=this.kanji){var parent=this,loader;this.paper.clear(),this.paper.text(0,0,this.kanji).attr({x:50,y:50,fill:"black","font-size":18,"text-anchor":"start"});var code=this.kanji.charCodeAt(0).toString(16);jQuery.ajax({url:"https://data.mazii.net/kanji/0"+code+".svg",dataType:"xml",success:function(results){parent.fetchNeeded=!1,parent.xml=results,parent.drawKanji()},error:function(jqXHR,status,error){var error;parent.paper.clear(),parent.paper.text(0,0,parent.kanji).attr({x:10,y:50,fill:"black","font-size":80,"stroke-width":2,stroke:"#FFFFFF","text-anchor":"start"})}})}else this.drawKanji()},createStroke:function(path,color){var stroke=this.paper.path(jQuery(path).attr("d"));return stroke.initialColor=color,stroke.attr({stroke:color,"stroke-width":this.strokeWidth,"stroke-linecap":"round","stroke-linejoin":"round"}),stroke},createHover:function(stroke){var onEnteredAnim=Raphael.animation({stroke:"black"},300),onLeftAnim=Raphael.animation({stroke:stroke.initialColor},300);stroke.hover(function(){this.animate(onEnteredAnim)},function(){this.animate(onLeftAnim)})},createHovers:function(strokes){for(var parent=this,onEnteredAnim=Raphael.animation({stroke:"black"},300),onLeftAnim=Raphael.animation({stroke:strokes[0].initialColor},300),i=0;i<strokes.length;i++){var stroke=strokes[i];stroke.hover(function(){for(var j=0;j<strokes.length;j++)(stroke=strokes[j]).attr({cursor:"pointer"}),stroke.animate(onEnteredAnim)},function(){for(var j=0;j<strokes.length;j++)(stroke=strokes[j]).animate(onLeftAnim)}),stroke.click(function(){parent.setKanji(strokes.element),parent.refreshKanji()})}},drawKanji:function(){var parent=this;this.paper.clear(),Raphael.getColor.reset();var groups=jQuery(this.xml).find("svg > g > g > g");this.colorGroups&&0!=groups.length?groups.each(function(){var color=Raphael.getColor();parent.paper.setStart(),jQuery(this).find("path").each(function(){parent.createStroke(this,color)});var set=parent.paper.setFinish(),element=jQuery(this).attr("kvg:element");if(void 0==element){for(var inners=jQuery(this).find("g"),i=0;i<inners.length;i++)if(void 0!==(element=jQuery(inners[i]).attr("kvg:element"))){set.element=element;break}}else set.element=element;parent.createHovers(set)}):jQuery(this.xml).find("path").each(function(){var color=Raphael.getColor(),stroke=parent.createStroke(this,color);parent.createHover(stroke)}),jQuery(this.xml).find("text").each(function(){var color=Raphael.color("#808080"),text=jQuery(this).text(),transform=jQuery(this).attr("transform"),x=transform.split(" ")[4],y=transform.split(" ")[5].replace(")",""),order=parent.paper.text(x,y,text);order.attr({fill:color,"font-size":parent.fontSize}),parent.displayOrders||order.hide()})}};